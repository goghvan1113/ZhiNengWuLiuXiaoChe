### 2021.10.08

- 设置速度环，并能观察出波形，得出98个脉冲值和实际最大有载速度的关系，m/s或者说另一种表达方式。
- 速度解算SpeedSolving.c中的速度解算函数能够正确计算出四电机速度环的参数。
- wheelcoderun.c 位置环定义运行代码 先拿省赛代码实现电机转固定圈数，并观察波形。
- 再修改为国赛代码setCarGoto()的方法，问下汪院那个45度移动到固定位置的函数。
- 舵机驱动函数并根据场景自动运行。

### 2021.10.09

- 位置环更新时修改的结构体成员是否是应该修改的结构体成员。

### 2021.10.11

- 1号轮的速度在10ms读取到的值最大值变为65
- L298N的驱动能力不如Tb6612FNG，在占空比达到1000时电机才能速度很慢的转动，当占空比小于1000时，电机会发出微弱的蜂鸣并且无法转动；TB6612在调试时在CNT值达到300即可转动（ARR为2000），因此用同一套速度环无法驱动电机转动
- 应用陀螺仪调整位置环PID时，KP的计算公式为2/(总时间-匀加速和匀速的时间)*0.95，这个位置环是没有用到PID斜坡的，但是写了一个均加速和匀速、匀减速的过程，因此也只有KP的定义。
- 在位置环控制速度环的时候，位置环固定在某一位置但不是最终的位置点，因此还会把Out输出给速度环，在速度环把Target转换为Pulse时，虽然说去掉了电机的死区，但是速度环始终有一个较大的Target，且转化为速度环的输出时会在正负值之间跳动，可能就是电机在位置环停住的地方为什么响的原因。
- 前面提到电机的响声，电机在不转的时候，甚至在转的时候会发出微弱的蜂鸣，这是由于电机设定了转速即占空比，但是在于电机驱动板的原因，会存在死区，导致电机无法转动，**这一点与第二点相结合**。

### 2021.10.12

- 这一天的调试重点是把SetCarGoto()函数里面关于5ms执行一次的代码转为自己的20ms执行一次的位置环更新策略。
- 还有陀螺仪对于YAW轴的作用。

### 2021.10.13

- SetCarGoto()函数的实现，基于全场定位编码器得到x，y方向移动的距离才能进行PID计算，因此我们不考虑wcc国赛的代码实现。

- 在省赛代码中，采用YAW轴陀螺仪角度环调整小车偏向的问题，加上巡线的PID计算，算出x，y轴的偏向速度，加在PID并进行速度解算，没有位置环。在巡线时，给出小车三轴的速度然后进行数线计算，之后再进行停车、转向等处理。

- 在速度解算的代码中有两种形式，一种是直接根据输入的速度计算轮子的转速，没有量纲之间的变化；另一种是以输入mm/s的速度转化为每次更新速度环的脉冲值，更好用。

- **调试需要注意的几点：在motor.c文件中的可以根据宏定义修改电机死区的值；在设定速度环的Target时，注意要小于在10ms（速度环的更新周期）内编码器能得到的最大值（90个脉冲对应345rpm）。**

- 给出智能物流小车程序的结构：

  底盘：YAW轴选择更新角度环的模式，然后将巡线时造成的偏差赋予到x或y轴的速度上，通过速度解算到四个轮子的速度环上；判断过了几条线，到达位置后给速度为0；

  云台：

### 2021.10.15

- 当速度环给小车的速度为0时，小车电机就会一直抖动，或者当速度环给电机的PWM波占空比小于电机的死区时，电机也会抖动蜂鸣。
- 赛道调试时，调节循迹模块，循迹针对速度环，陀螺仪给速度环，达到不歪。

### 2021.10.16

- 云台舵机的动作执行设置为动作组的方式。穷举法列举出云台舵机的动作
